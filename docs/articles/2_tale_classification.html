<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tantale">
<title>2. Classifying TALE sequences from genomes with tantale • tantale</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Classifying TALE sequences from genomes with tantale">
<meta property="og:description" content="tantale">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tantale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/1_tale_mining.html">1. Mining TALE sequences in genomes with tantale</a>
    <a class="dropdown-item" href="../articles/2_tale_classification.html">2. Classifying TALE sequences from genomes with tantale</a>
    <a class="dropdown-item" href="../articles/3_tale_msa.html">3. Multiple alignment of TALE sequences with tantale</a>
    <a class="dropdown-item" href="../articles/4_tale_target_prediction.html">4. TALE targets predictions with tantale</a>
    <a class="dropdown-item" href="../articles/p1_distalr.html">A comparison between `runDistal` and `distalr` implementations</a>
    <a class="dropdown-item" href="../articles/p2_multiple_alignments.html">TALEs domains sequences alignment with MAFFT</a>
    <a class="dropdown-item" href="../articles/p3_tantale_objects.html">An overview of the various objects related to TALEs in tantale</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/scunnac/tantale/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="2_tale_classification_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="2_tale_classification_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="2_tale_classification_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="2_tale_classification_files/datatables-binding-0.29/datatables.js"></script><link href="2_tale_classification_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="2_tale_classification_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="2_tale_classification_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="2_tale_classification_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="2_tale_classification_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>2. Classifying TALE sequences from genomes with tantale</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/scunnac/tantale/blob/HEAD/../../../vignettes/2_tale_classification.Rmd" class="external-link"><code>../../../vignettes/2_tale_classification.Rmd</code></a></small>
      <div class="d-none name"><code>2_tale_classification.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scunnac.github.io/tantale">tantale</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biostrings" class="external-link">Biostrings</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/talgalili/gplots" class="external-link">gplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/" class="external-link">ggtree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/corrr" class="external-link">corrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/wiki/ggcorrplot-visualization-of-a-correlation-matrix-using-ggplot2" class="external-link">ggcorrplot</a></span><span class="op">)</span></span></code></pre></div>
<p>Based on the results of the first article “Mining TALE sequences in genomes with tantale”, this second section will cover steps downstream of <em>tal</em> loci prediction. It will illustrate TALE classification into groups of related sequences with functions in package <code>tantale</code>.<br>
As a reminder, the genomes used for this article are MAI1, BAI3, BAI3-1-1 (an error-prone genome with TalC deleted) and PXO86, an outgroup Asian strain.<br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outdir</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span><span class="st">"~/TEMP/test_tantale"</span><span class="op">)</span> <span class="co"># tempdir(check = TRUE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"mining.RData"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="classify-the-various-tale-sequences-into-groups-of-related-sequences">Classify the various TALE sequences into groups of related sequences<a class="anchor" aria-label="anchor" href="#classify-the-various-tale-sequences-into-groups-of-related-sequences"></a>
</h2>
<p>To classify TALE groups, we use the function <code><a href="../reference/runDistal.html">runDistal()</a></code> to run the tool DisTal that outputs similarity between TALEs and similarity between repeats. The TALE similarity table can be taken as input of <code><a href="../reference/groupTales.html">groupTales()</a></code> for clustering groups, and the repeats similarity can be used for plotting multiple alignment of Tals within group.</p>
<div class="section level3">
<h3 id="run-distal">Run DisTal<a class="anchor" aria-label="anchor" href="#run-distal"></a>
</h3>
<p>We run DisTal for all the putative TALE ORFs (from <code>telltale</code> output).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distal_telltale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"distal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">distal_telltale</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">distal_telltale</span>, showWarnings <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">telltale_cds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">distal_telltale</span>, <span class="st">"cds.fasta"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">telltale_cds</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">distal_telltale_input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">telltale_outdir</span>,</span>
<span>                                    <span class="st">"putativeTalOrf.fasta"</span>,</span>
<span>                                    recursive <span class="op">=</span> <span class="cn">T</span>, full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">distal_telltale_input</span> <span class="op">&lt;-</span> <span class="va">distal_telltale_input</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"ROI"</span>, <span class="va">distal_telltale_input</span>, fixed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">input</span> <span class="kw">in</span> <span class="va">distal_telltale_input</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ttRunId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\_.+"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">seqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readBStringSet</a></span><span class="op">(</span><span class="va">input</span>, seek.first.rec <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ttRunId</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">seqs</span> <span class="op">&lt;-</span> <span class="va">seqs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">seqs</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="co">#cat(names(seqs))</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">writeXStringSet</a></span><span class="op">(</span><span class="va">seqs</span>, <span class="va">telltale_cds</span>, append <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># run DisTal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">distal_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runDistal.html">runDistal</a></span><span class="op">(</span><span class="va">telltale_cds</span>, outdir <span class="op">=</span> <span class="va">distal_telltale</span>, overwrite <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;&gt; 629.049   0.097 629.173</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-the-r-implementation-of-distal">run the R implementation of DisTal<a class="anchor" aria-label="anchor" href="#run-the-r-implementation-of-distal"></a>
</h3>
<p>First we use the tellTale output directories for each genome and get the information about TALE parts (ie domains). The final output is a tibble with a single part per row.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># distalrOutDir &lt;- file.path(outdir, "distalr")</span></span>
<span><span class="co"># unlink(distalrOutDir, recursive = TRUE)</span></span>
<span><span class="co"># dir.create(distalrOutDir, showWarnings = F)</span></span>
<span></span>
<span></span>
<span><span class="va">taleParts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.dirs</a></span><span class="op">(</span><span class="va">telltale_outdir</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ttGenomeDir</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">genomeId</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_.*correction"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/path.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">ttGenomeDir</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">logger</span><span class="fu">::</span><span class="fu"><a href="https://daroczig.github.io/logger/reference/log_level.html" class="external-link">log_debug</a></span><span class="op">(</span><span class="st">"Current genome: {genomeId}"</span><span class="op">)</span></span>
<span>  <span class="va">taleParts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTaleParts.html">getTaleParts</a></span><span class="op">(</span><span class="va">ttGenomeDir</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>arrayID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">genomeId</span>, <span class="st">"_"</span>, <span class="va">arrayID</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">taleParts</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taleParts</span><span class="op">)</span>, caption <span class="op">=</span> <span class="st">"An example of the content of the taleParts tibble."</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-698f4d7fd5dfcfc9e01e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-698f4d7fd5dfcfc9e01e">{"x":{"filter":"none","vertical":false,"caption":"<caption>An example of the content of the taleParts tibble.<\/caption>","data":[["1","2","3","4","5","6"],["BAI3_ROI_00001","BAI3_ROI_00001","BAI3_ROI_00001","BAI3_ROI_00001","BAI3_ROI_00001","BAI3_ROI_00001"],["N-terminus","repeat","repeat","repeat","repeat","repeat"],[1,2,3,4,5,6],[null,1,2,3,4,5],["ATGGATCCCATTCGTCCGCGCGCGCCAAGTCCTGCCCGCGAGGTTCTGCCCGGCCCCCAACCGGATAGGGTTCAGCCGACTGCAGATCGTGGGGTGTCTGCGCCTGCTGGCAGCCCTCTGGATGGCTTGCCCGCTCGGCGGACGATGTCCCGGACCCGGCTGCCATCTCCCCCTGCCCCCTTGCCTGCGTTCTCGGCGGGCAGCTTCAGCGATCTGCTCCGTCAGTTCGATCCGTCGCTTCTTGATACATCGCTTTTTGATTCGATGCCTGCCGTCGGCACGCCTCATACAGAGGCTGCCCCAGCAGAGGGGGATGAGGTGCAATCGGCTCTGCGTGCAGCCGATGACCCGCCACCCACCGTGCGTGTCGCTGTCACTGCCGCGCAGGTGGATCTACGCACGCTCGGCTACAGTCAGCAGCAAGAGAAGATCAAACCGAATGTTCGTTCGACAGTGGCGCAGCACCACGAGGCACTGGTGGGCCATGGGTTTACACACGCGCACATCGTTGCGCTCAGCCGACACCCGGCAGCGTTAGGGACCGTCGCTGTCAAGTATCAGGACATGATCGCGGCGTTACCAGAGGCGACACACGAAGACATCGTTGGGGTCGGCAAACAGTGTTCCGGCGCACGCGCCCTGGAGGCCTTGCTCACGGTGGCGGGAGAGTTGAGAGGTCCACCGTTACAGTTGGACACAGGCCAACTTGTCAAGATTGCAAAACGTGGCGGCGTGACCGCAGTGGAGGCAGTGCATGCATCGCGCAATGCACTGACGGGTGCCCCCCTGAAC","CTGACCCCGGCACAGGTGGTGGCCATCGCCAGCAATAGCGGCGGCAAGCAGGCGCTGGAGACGGTGCAGCGGCTGTTGCCGGTGCTGTGCCAGGCCCATGGC","CTGACCCCGGAGCAGGTGGTGGCCATCGCCAGCAATGGCGGCGGCAAGCAGGCGCTGGAGACGGTGCAGCGGCTGTTGCCGGTGCTGTGCCAGGCCCATGGC","CTGACCCCGGCGCAGGTGGTGGCCATCGCCAGCAATAGCGGCGGCAAGCAGGCGCTGGAGACGGTGCAGCGGCTGTTGCCGGTGCTGTGCCAGGCCCATGGC","CTGACCCCGGACCAGGTGGTGGCCATCGCCAGCCACGATGGCGGCAAGCAGGCGCTGGAGACGGTGCAGCGACTGTTGCCGGTGCTGTGCCAGGCCCATGGC","CTGACCCCGGAGCAGGTGGTGGCCATCGCCAGCAATATTGGCGGCAAGCAGGCGCTGGAGACGGTGCAGCGGCTGTTGCCGGTGCTGTGCCAGGCCCATGGC"],["/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001","/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001","/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001","/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001","/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001","/home/cunnac/TEMP/test_tantale/telltale/BAI3_nocorrection/annotale/ROI_00001"],["MDPIRPRAPSPAREVLPGPQPDRVQPTADRGVSAPAGSPLDGLPARRTMSRTRLPSPPAPLPAFSAGSFSDLLRQFDPSLLDTSLFDSMPAVGTPHTEAAPAEGDEVQSALRAADDPPPTVRVAVTAAQVDLRTLGYSQQQEKIKPNVRSTVAQHHEALVGHGFTHAHIVALSRHPAALGTVAVKYQDMIAALPEATHEDIVGVGKQCSGARALEALLTVAGELRGPPLQLDTGQLVKIAKRGGVTAVEAVHASRNALTGAPLN","LTPAQVVAIASNSGGKQALETVQRLLPVLCQAHG","LTPEQVVAIASNGGGKQALETVQRLLPVLCQAHG","LTPAQVVAIASNSGGKQALETVQRLLPVLCQAHG","LTPDQVVAIASHDGGKQALETVQRLLPVLCQAHG","LTPEQVVAIASNIGGKQALETVQRLLPVLCQAHG"],["NTERM","NS","NG","NS","HD","NI"],["BAI3","BAI3","BAI3","BAI3","BAI3","BAI3"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>arrayID<\/th>\n      <th>domainType<\/th>\n      <th>positionInArray<\/th>\n      <th>positionInCrd<\/th>\n      <th>dnaSeq<\/th>\n      <th>sourceDirectory<\/th>\n      <th>aaSeq<\/th>\n      <th>rvd<\/th>\n      <th>seqnames<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>With this kind of representation it is quite easy to make summary plots like this one for example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partsForPlots</span> <span class="op">&lt;-</span> <span class="va">taleParts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">domainType</span> <span class="op">==</span> <span class="st">"repeat"</span>, <span class="va">rvd</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>         aaSeqLength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">aaSeq</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">partsForPlots</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">aaSeqLength</span>,</span>
<span>                                       color <span class="op">=</span> <span class="va">domainType</span>,</span>
<span>                                       label <span class="op">=</span> <span class="va">label</span>,</span>
<span>                                       y <span class="op">=</span> <span class="va">arrayID</span>,</span>
<span>                                       x <span class="op">=</span> <span class="va">positionInArray</span><span class="op">)</span>,</span>
<span>                         color <span class="op">=</span> <span class="va">isNaAaSeq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"rocket"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">5</span>, stroke <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggnewscale</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/ggnewscale/reference/new_scale.html" class="external-link">new_scale_color</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggnewscale</span><span class="fu">::</span><span class="fu"><a href="https://eliocamp.github.io/ggnewscale/reference/new_scale.html" class="external-link">new_scale_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">seqnames</span><span class="op">~</span> <span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, space <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Overview of TALE composition by genome"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/Overview%20of%20TALE%20composition%20by%20genome-1.png" width="960"></p>
<p>Now, with this <code>tibble</code>, we can also run the R implementation of the Distal Perl code.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">partsForDistalr</span> <span class="op">&lt;-</span> <span class="va">taleParts</span></span>
<span></span>
<span><span class="co"># distalr_mms_output &lt;- distalr(taleParts = partsForDistalr,</span></span>
<span><span class="co">#                               repeats.cluster.h.cut = 10, ncores = 6,</span></span>
<span><span class="co">#                               pairwiseAlnMethod = "mmseq2",</span></span>
<span><span class="co">#                               condaBinPath = "/home/cunnac/bin/miniconda3/condabin/conda")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span><span class="va">distalr_deci_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distalr.html">distalr</a></span><span class="op">(</span>taleParts <span class="op">=</span> <span class="va">partsForDistalr</span>,</span>
<span>                              repeats.cluster.h.cut <span class="op">=</span> <span class="fl">10</span>, ncores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                              pairwiseAlnMethod <span class="op">=</span> <span class="st">"DECIPHER"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;&gt;  15.581   0.154   4.953</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span><span class="va">distalr_bs_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distalr.html">distalr</a></span><span class="op">(</span>taleParts <span class="op">=</span> <span class="va">partsForDistalr</span>,</span>
<span>                             repeats.cluster.h.cut <span class="op">=</span> <span class="fl">10</span>, ncores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                             pairwiseAlnMethod <span class="op">=</span> <span class="st">"Biostrings"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;     user   system  elapsed </span></span>
<span><span class="co">#&gt;&gt; 1857.152    3.161  425.256</span></span></code></pre></div>
<p>Clearly, the “DECIPHER” method for pairwise alignment of domains aa sequences is much faster than all the others.</p>
</div>
<div class="section level3">
<h3 id="contrast-the-output-of-the-various-distal-functions">Contrast the output of the various distal functions<a class="anchor" aria-label="anchor" href="#contrast-the-output-of-the-various-distal-functions"></a>
</h3>
<p>Now, we can take a look at whether the results of the original Distal script are consistent with our R implementation of the program.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">talSimOutAgregated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>distalALV <span class="op">=</span> <span class="va">distal_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>     distalDECI <span class="op">=</span> <span class="va">distalr_deci_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>     distalBIOS <span class="op">=</span> <span class="va">distalr_bs_output</span><span class="op">$</span><span class="va">tal.similarity</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"method"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">talSimOutAgregatedLong</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">talSimOutAgregated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">TAL1</span>, <span class="va">TAL2</span>, <span class="va">Sim</span><span class="op">)</span>,</span>
<span>                                          formula <span class="op">=</span> <span class="va">method</span> <span class="op">~</span> <span class="va">TAL1</span> <span class="op">+</span> <span class="va">TAL2</span>, value.var <span class="op">=</span> <span class="st">"Sim"</span></span>
<span>                                            <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">talSimOutAgregatedLong</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">talSimOutAgregatedLong</span><span class="op">$</span><span class="va">method</span></span>
<span><span class="va">talSimOutAgregatedLong</span><span class="op">$</span><span class="va">method</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">talSimOutAgregatedLong</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">talSimOutAgregatedLong</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">corr_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">talSimOutAgregatedLong</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">corr_matrix</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">distalALV</th>
<th align="right">distalBIOS</th>
<th align="right">distalDECI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">distalALV</td>
<td align="right">1.0000000</td>
<td align="right">0.9533716</td>
<td align="right">0.9547991</td>
</tr>
<tr class="even">
<td align="left">distalBIOS</td>
<td align="right">0.9533716</td>
<td align="right">1.0000000</td>
<td align="right">0.9961920</td>
</tr>
<tr class="odd">
<td align="left">distalDECI</td>
<td align="right">0.9547991</td>
<td align="right">0.9961920</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ggcorrplot/man/ggcorrplot.html" class="external-link">ggcorrplot</a></span><span class="op">(</span><span class="va">corr_matrix</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/correlation%20of%20TALE%20similarity%20from%20various%20distal%20implementations-1.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">talSimOutAgregated</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">dcast</a></span><span class="op">(</span><span class="va">talSimOutAgregated</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">TAL1</span>, <span class="va">TAL2</span>, <span class="va">Sim</span><span class="op">)</span>,</span>
<span>                                          formula <span class="op">=</span> <span class="va">TAL1</span> <span class="op">+</span> <span class="va">TAL2</span> <span class="op">~</span> <span class="va">method</span>, value.var <span class="op">=</span> <span class="st">"Sim"</span></span>
<span>                                            <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># talSimOutAgregated %&gt;%</span></span>
<span><span class="co">#   select(-distalBIOS) %&gt;%</span></span>
<span><span class="co">#   mutate(pointLab = paste(TAL1, TAL2, sep = "|")) %&gt;%</span></span>
<span><span class="co">#   ggplot(mapping = aes(x = distalALV, distalDECI)) +</span></span>
<span><span class="co">#   geom_point() +</span></span>
<span><span class="co">#   geom_abline(intercept = 0, slope = 1)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">talSimOutAgregated</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, lower.panel <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/pair%20plot%20of%20TALE%20similarity%20from%20various%20distal%20implementations-1.png" width="384"></p>
<p>The correlation of the TALE pairwise similarity scores output by the various distal flavors are remarkably high.</p>
</div>
<div class="section level3">
<h3 id="allocate-tales-to-groups-of-related-sequences">Allocate TALEs to groups of related sequences<a class="anchor" aria-label="anchor" href="#allocate-tales-to-groups-of-related-sequences"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">22</span></span>
<span><span class="va">groupsALV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distal_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>, k_test <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"k-medoids"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; tale tree will not be plotted!</span></span>
<span><span class="co">#&gt;&gt; Number of groups is decided based on the provided value of k: 22</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">groupsDECI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distalr_deci_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>, k_test <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"k-medoids"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; tale tree will not be plotted!</span></span>
<span><span class="co">#&gt;&gt; Number of groups is decided based on the provided value of k: 22</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-2.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">groupsBIOS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distalr_bs_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>, k_test <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"k-medoids"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; tale tree will not be plotted!</span></span>
<span><span class="co">#&gt;&gt; Number of groups is decided based on the provided value of k: 22</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-3.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distal_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"hclust"</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-4.png" width="576"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distalr_deci_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"hclust"</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-5.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupTales.html">groupTales</a></span><span class="op">(</span>taleSim <span class="op">=</span> <span class="va">distalr_bs_output</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>                     plotTree <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="va">k</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"hclust"</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees-6.png" width="576"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span><span class="va">getTALEsTree</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">taleSim</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">distMat</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html" class="external-link">acast</a></span><span class="op">(</span><span class="va">taleSim</span>, formula <span class="op">=</span> <span class="va">TAL1</span> <span class="op">~</span> <span class="va">TAL2</span>, value.var <span class="op">=</span> <span class="st">"Sim"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">distMat</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ward.D"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can compare the hierarchical trees obtained with the original Distal tree (left) and distalr with DICEPHER (right). Because PXO86 is the only Asian strain and these TALEs are rather distantly related to African ones, the part of the trees with PXO86 TALEs are not really meaningfull in this context.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/cophyloplot.html" class="external-link">cophyloplot</a></span><span class="op">(</span><span class="fu">getTALEsTree</span><span class="op">(</span><span class="va">distal_output</span><span class="op">$</span><span class="va">tal.similarity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/as.phylo.html" class="external-link">as.phylo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 <span class="fu">getTALEsTree</span><span class="op">(</span><span class="va">distalr_deci_output</span><span class="op">$</span><span class="va">tal.similarity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/as.phylo.html" class="external-link">as.phylo</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 assoc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">distal_output</span><span class="op">$</span><span class="va">tal.similarity</span><span class="op">$</span><span class="va">TAL1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                                ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 length.line <span class="op">=</span> <span class="fl">0</span>, space<span class="op">=</span><span class="fl">200</span>, gap <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                 col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="2_tale_classification_files/figure-html/tale%20trees%20comparisons-1.png" width="768"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taleGroups</span> <span class="op">&lt;-</span> <span class="va">groupsDECI</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">name</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">taleGroups</span>, n<span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="right">group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">BAI3_ROI_00001</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">MAI1_ROI_00001</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">BAI3-1-1_ROI_00001</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">BAI3_ROI_00002</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">MAI1_ROI_00002</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">BAI3-1-1_ROI_00002</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">BAI3_ROI_00003</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">MAI1_ROI_00003</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">BAI3-1-1_ROI_00003</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">BAI3_ROI_00004</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">MAI1_ROI_00004</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">BAI3-1-1_ROI_00005</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>Based on the silhouette values, <code><a href="../reference/groupTales.html">groupTales()</a></code> will take the value at the elbow of the curve. In this case we manually took k = 22`.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save.image</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"mining.RData"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bao Tram Vi, Sebastien Cunnac.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
