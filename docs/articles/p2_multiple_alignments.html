<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tantale">
<title>TALEs domains sequences alignment with MAFFT â€¢ tantale</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TALEs domains sequences alignment with MAFFT">
<meta property="og:description" content="tantale">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tantale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9550</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/1_tale_mining.html">1. Mining TALE sequences in genomes with tantale</a>
    <a class="dropdown-item" href="../articles/2_tale_classification.html">2. Classifying TALE sequences from genomes with tantale</a>
    <a class="dropdown-item" href="../articles/3_tale_msa.html">3. Multiple alignment of TALE sequences with tantale</a>
    <a class="dropdown-item" href="../articles/4_tale_target_prediction.html">4. TALE targets predictions with tantale</a>
    <a class="dropdown-item" href="../articles/p1_distalr.html">A comparison between `runDistal` and `distalr` implementations</a>
    <a class="dropdown-item" href="../articles/p2_multiple_alignments.html">TALEs domains sequences alignment with MAFFT</a>
    <a class="dropdown-item" href="../articles/p3_tantale_objects.html">An overview of the various objects related to TALEs in tantale</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/scunnac/tantale/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>TALEs domains sequences alignment with MAFFT</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/scunnac/tantale/blob/HEAD/vignettes/p2_multiple_alignments.Rmd" class="external-link"><code>vignettes/p2_multiple_alignments.Rmd</code></a></small>
      <div class="d-none name"><code>p2_multiple_alignments.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scunnac.github.io/tantale">tantale</a></span><span class="op">)</span></span></code></pre></div>
<p>This demo will illustrate how to use the <code>buildRepeatMsa</code>
function to produce TALE sequence multiple algnments.<br></p>
<p>Additionally, using real life distalr output, it will details the
various type of aesthetics that can be used to plot those TALEs msa.</p>
<div class="section level2">
<h2 id="producing-simple-tale-sequence-multiple-algnments">Producing simple TALE sequence multiple algnments<a class="anchor" aria-label="anchor" href="#producing-simple-tale-sequence-multiple-algnments"></a>
</h2>
<p>Here we start with RVD sequences of the African Xoo TALE TalA:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aln</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildRepeatMsa.html">buildRepeatMsa</a></span><span class="op">(</span>inputSeqs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"TalA_RVDSeqs_AnnoTALE.fasta"</span>,</span>
<span>                                              package <span class="op">=</span> <span class="st">"tantale"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                      sep <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>                      distalRepeatSims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                      mafftOpts <span class="op">=</span> <span class="st">"--localpair --maxiterate 1000 --quiet --reorder --op 0 --ep 5 --thread 1"</span>,</span>
<span>                      gapSymbol <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></code></pre></div>
<p>The output shown as a simple matrix :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">aln</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="15%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
<col width="3%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
<th align="left">11</th>
<th align="left">12</th>
<th align="left">13</th>
<th align="left">14</th>
<th align="left">15</th>
<th align="left">16</th>
<th align="left">17</th>
<th align="left">18</th>
<th align="left">19</th>
<th align="left">20</th>
<th align="left">21</th>
<th align="left">22</th>
<th align="left">23</th>
<th align="left">24</th>
<th align="left">25</th>
<th align="left">26</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TalA_BAI3</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="even">
<td align="left">TalA_CFBP1947</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="odd">
<td align="left">TalA_MAI1</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="even">
<td align="left">TalA_MAI134</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="odd">
<td align="left">TalA_MAI106</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="even">
<td align="left">TalA_MAI129</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="odd">
<td align="left">TalA_MAI145</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="even">
<td align="left">TalA_MAI68</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="odd">
<td align="left">TalA_MAI73</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="even">
<td align="left">TalA_MAI95</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
<tr class="odd">
<td align="left">TalA_MAI99</td>
<td align="left">NN</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">NN</td>
<td align="left">HD</td>
<td align="left">NS</td>
<td align="left">NG</td>
<td align="left">NI</td>
<td align="left">N*</td>
<td align="left">NN</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NI</td>
<td align="left">NI</td>
<td align="left">NG</td>
<td align="left">HD</td>
<td align="left">NN</td>
<td align="left">NG</td>
</tr>
</tbody>
</table>
<p>Now, it is more evolutionarily relevant to look at Distal
parts/domain/repeat (this is used somehow interchangeably with roughly
the same meaning) code sequences. Needless to say that to obtain TALE
parts code sequences, you need beforehand to run either the original
Distal perl script with <code>runDistal</code> or our R implementation
<code>distalr</code> with DNA sequences. In this cas we just use a toy
example provided with tantale.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aln</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildRepeatMsa.html">buildRepeatMsa</a></span><span class="op">(</span>inputSeqs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"small_Out_CodedRepeats.fa"</span>,</span>
<span>                                              package <span class="op">=</span> <span class="st">"tantale"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                      sep <span class="op">=</span> <span class="st">" "</span>,</span>
<span>                      distalRepeatSims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                      mafftOpts <span class="op">=</span> <span class="st">"--localpair --maxiterate 1000 --quiet --reorder --op 0 --ep 5 --thread 1"</span>,</span>
<span>                      gapSymbol <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></code></pre></div>
<p><strong>NOTE</strong>, the difference in the <code>sep</code>
parameter value.</p>
<p>The output shown as a simple matrix :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">aln</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="44%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
<th align="left">5</th>
<th align="left">6</th>
<th align="left">7</th>
<th align="left">8</th>
<th align="left">9</th>
<th align="left">10</th>
<th align="left">11</th>
<th align="left">12</th>
<th align="left">13</th>
<th align="left">14</th>
<th align="left">15</th>
<th align="left">16</th>
<th align="left">17</th>
<th align="left">18</th>
<th align="left">19</th>
<th align="left">20</th>
<th align="left">21</th>
<th align="left">22</th>
<th align="left">23</th>
<th align="left">24</th>
<th align="left">25</th>
<th align="left">26</th>
<th align="left">27</th>
<th align="left">28</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MAI1|MAI1_chr1_+_2218220_2222519_25.5</td>
<td align="left">99</td>
<td align="left">48</td>
<td align="left">59</td>
<td align="left">48</td>
<td align="left">54</td>
<td align="left">72</td>
<td align="left">17</td>
<td align="left">40</td>
<td align="left">58</td>
<td align="left">72</td>
<td align="left">17</td>
<td align="left">37</td>
<td align="left">64</td>
<td align="left">31</td>
<td align="left">67</td>
<td align="left">37</td>
<td align="left">62</td>
<td align="left">58</td>
<td align="left">48</td>
<td align="left">37</td>
<td align="left">54</td>
<td align="left">44</td>
<td align="left">24</td>
<td align="left">20</td>
<td align="left">31</td>
<td align="left">63</td>
<td align="left">36</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">Xoo_BAI3|Xoo|BAI3|Seq1_+_2227619_2231921_25.5</td>
<td align="left">100</td>
<td align="left">48</td>
<td align="left">37</td>
<td align="left">48</td>
<td align="left">54</td>
<td align="left">72</td>
<td align="left">19</td>
<td align="left">41</td>
<td align="left">16</td>
<td align="left">54</td>
<td align="left">62</td>
<td align="left">58</td>
<td align="left">81</td>
<td align="left">31</td>
<td align="left">43</td>
<td align="left">37</td>
<td align="left">44</td>
<td align="left">37</td>
<td align="left">48</td>
<td align="left">75</td>
<td align="left">32</td>
<td align="left">44</td>
<td align="left">21</td>
<td align="left">37</td>
<td align="left">31</td>
<td align="left">63</td>
<td align="left">36</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">Xoo_CFBP1947|Xoo|CFBP1947|Seq1_-_2480624_2484926_25.5</td>
<td align="left">100</td>
<td align="left">48</td>
<td align="left">37</td>
<td align="left">48</td>
<td align="left">54</td>
<td align="left">72</td>
<td align="left">19</td>
<td align="left">41</td>
<td align="left">16</td>
<td align="left">54</td>
<td align="left">62</td>
<td align="left">58</td>
<td align="left">81</td>
<td align="left">31</td>
<td align="left">43</td>
<td align="left">37</td>
<td align="left">44</td>
<td align="left">37</td>
<td align="left">48</td>
<td align="left">75</td>
<td align="left">32</td>
<td align="left">44</td>
<td align="left">21</td>
<td align="left">37</td>
<td align="left">31</td>
<td align="left">63</td>
<td align="left">36</td>
<td align="left">10</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="a-detailled-illustration-of-one-of-the-tale-msa-plotting-functions">A detailled illustration of one of the TALE msa plotting
functions<a class="anchor" aria-label="anchor" href="#a-detailled-illustration-of-one-of-the-tale-msa-plotting-functions"></a>
</h2>
<p>First we get the necessary info from object from a previous run:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distalrOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sampleDistalrOutput.rds"</span>,</span>
<span>                                              package <span class="op">=</span> <span class="st">"tantale"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">repeatMsaByGroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sampleRepeatMsaByGroup.rds"</span>,</span>
<span>                                              package <span class="op">=</span> <span class="st">"tantale"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">repeatAlign</span> <span class="op">&lt;-</span> <span class="va">repeatMsaByGroup</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">rvdAlign</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convertRepeat2RvdAlign.html">convertRepeat2RvdAlign</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>                                   repeat2RvdMapping <span class="op">=</span> <span class="fu"><a href="../reference/getRepeat2RvdMappingFromDistalr.html">getRepeat2RvdMappingFromDistalr</a></span><span class="op">(</span><span class="va">distalrOut</span><span class="op">$</span><span class="va">taleParts</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This is what you get if you provide all the arguments:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; Registered S3 methods overwritten by 'treeio':</span></span>
<span><span class="co">#&gt;&gt;   method              from    </span></span>
<span><span class="co">#&gt;&gt;   MRCA.phylo          tidytree</span></span>
<span><span class="co">#&gt;&gt;   MRCA.treedata       tidytree</span></span>
<span><span class="co">#&gt;&gt;   Nnode.treedata      tidytree</span></span>
<span><span class="co">#&gt;&gt;   Ntip.treedata       tidytree</span></span>
<span><span class="co">#&gt;&gt;   ancestor.phylo      tidytree</span></span>
<span><span class="co">#&gt;&gt;   ancestor.treedata   tidytree</span></span>
<span><span class="co">#&gt;&gt;   child.phylo         tidytree</span></span>
<span><span class="co">#&gt;&gt;   child.treedata      tidytree</span></span>
<span><span class="co">#&gt;&gt;   full_join.phylo     tidytree</span></span>
<span><span class="co">#&gt;&gt;   full_join.treedata  tidytree</span></span>
<span><span class="co">#&gt;&gt;   groupClade.phylo    tidytree</span></span>
<span><span class="co">#&gt;&gt;   groupClade.treedata tidytree</span></span>
<span><span class="co">#&gt;&gt;   groupOTU.phylo      tidytree</span></span>
<span><span class="co">#&gt;&gt;   groupOTU.treedata   tidytree</span></span>
<span><span class="co">#&gt;&gt;   inner_join.phylo    tidytree</span></span>
<span><span class="co">#&gt;&gt;   inner_join.treedata tidytree</span></span>
<span><span class="co">#&gt;&gt;   is.rooted.treedata  tidytree</span></span>
<span><span class="co">#&gt;&gt;   nodeid.phylo        tidytree</span></span>
<span><span class="co">#&gt;&gt;   nodeid.treedata     tidytree</span></span>
<span><span class="co">#&gt;&gt;   nodelab.phylo       tidytree</span></span>
<span><span class="co">#&gt;&gt;   nodelab.treedata    tidytree</span></span>
<span><span class="co">#&gt;&gt;   offspring.phylo     tidytree</span></span>
<span><span class="co">#&gt;&gt;   offspring.treedata  tidytree</span></span>
<span><span class="co">#&gt;&gt;   parent.phylo        tidytree</span></span>
<span><span class="co">#&gt;&gt;   parent.treedata     tidytree</span></span>
<span><span class="co">#&gt;&gt;   root.treedata       tidytree</span></span>
<span><span class="co">#&gt;&gt;   rootnode.phylo      tidytree</span></span>
<span><span class="co">#&gt;&gt;   sibling.phylo       tidytree</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa-1.png" width="1152"></p>
<p>The returned object can be modified :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; [1] "aplot"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plotlist</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; List of 2</span></span>
<span><span class="co">#&gt;&gt;  $ :List of 9</span></span>
<span><span class="co">#&gt;&gt;   ..- attr(*, "class")= chr [1:2] "gg" "ggplot"</span></span>
<span><span class="co">#&gt;&gt;  $ :List of 9</span></span>
<span><span class="co">#&gt;&gt;   ..- attr(*, "class")= chr [1:3] "ggtree" "gg" "ggplot"</span></span></code></pre></div>
<p>Plotting the original alignment</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span><span class="op">$</span><span class="va">plotlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/The%20alignment%20part%20of%20the%20aplot-1.png" width="1152"></p>
<p>Now we can modify the color scales and replot to check this is what
we want.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"modifying the original alignment as a ggplot"</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; modifying the original alignment as a ggplot</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p1</span><span class="op">$</span><span class="va">plotlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; Scale for <span style="color: #00BB00;">fill</span> is already present.</span></span>
<span><span class="co">#&gt;&gt; Adding another scale for <span style="color: #00BB00;">fill</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt;&gt; Scale for <span style="color: #00BB00;">colour</span> is already present.</span></span>
<span><span class="co">#&gt;&gt; Adding another scale for <span style="color: #00BB00;">colour</span>, which will replace the existing scale.</span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/The%20modified%20alignment%20part%20of%20the%20aplot-1.png" width="1152"></p>
<p>We can extract the tree part of the object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span><span class="op">$</span><span class="va">plotlist</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/The%20tree%20part%20of%20the%20aplot-1.png" width="240"></p>
<p>And we can recombine all again :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span><span class="op">$</span><span class="va">plotlist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p2</span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/reassembling%20align%20and%20tree-1.png" width="1152"></p>
<p>Pay attention to the arguments provided to the plotting function. In
the various calls to <code>ggplotTalesMsa</code>, arguments are
gradually removed to exemplify the type of alignments that are thus
displayed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatClust"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-1.png" width="1152"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-2.png" width="1152"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatClust"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-3.png" width="1152"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># fillType has no effect</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-4.png" width="1152"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-5.png" width="1152"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-6.png" width="1152"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-7.png" width="1152"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-8.png" width="1152"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Single sequence align</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               talsim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">tal.similarity</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-9.png" width="1152"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatClust"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-10.png" width="1152"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="va">distalrOut</span><span class="op">$</span><span class="va">repeat.similarity</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-11.png" width="1152"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="va">repeatAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-12.png" width="1152"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplotTalesMsa.html">ggplotTalesMsa</a></span><span class="op">(</span>repeatAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               talsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               repeatSim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               rvdAlign <span class="op">=</span> <span class="va">rvdAlign</span><span class="op">[</span><span class="fl">3</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>               refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               fillType <span class="op">=</span> <span class="st">"repeatSim"</span> <span class="co"># "repeatClust"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="p2_multiple_alignments_files/figure-html/detailled%20illustration%20of%20ggplotTalesMsa%20others-13.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="a-couple-of-utility-functions-for-tale-msa">A couple of utility functions for TALE msa<a class="anchor" aria-label="anchor" href="#a-couple-of-utility-functions-for-tale-msa"></a>
</h2>
<p>Compute the consensus of the columns in a TALE alignment:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/taleAlignConsensus.html">taleAlignConsensus</a></span><span class="op">(</span><span class="va">repeatAlign</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;  [1] "186" "62"  "48"  "133" "127" "155" "73"  "149" "157" "152" "51"  "118"</span></span>
<span><span class="co">#&gt;&gt; [13] "95"  "178" "94"  "57"  "64"  "177" "115" "26"  "26"  "37"  "50"  "64" </span></span>
<span><span class="co">#&gt;&gt; [25] "94"  "26"  "49"  "245"</span></span>
<span><span class="fu"><a href="../reference/taleAlignConsensus.html">taleAlignConsensus</a></span><span class="op">(</span><span class="va">rvdAlign</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;  [1] "NTERM" "NN"    "ND"    "NN"    "NI"    "NK"    "NN"    "HD"    "NN"   </span></span>
<span><span class="co">#&gt;&gt; [10] "NG"    "NG"    "N*"    "HD"    "N*"    "HD"    "NI"    "NN"    "HD"   </span></span>
<span><span class="co">#&gt;&gt; [19] "NG"    "HD"    "HD"    "HD"    "NG"    "NN"    "HD"    "HD"    "NG"   </span></span>
<span><span class="co">#&gt;&gt; [28] "CTERM"</span></span></code></pre></div>
<p>Figure out what elements in the TALE alignment corresponds to the
consensus:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/matchConsensus.html">matchConsensus</a></span><span class="op">(</span><span class="va">repeatAlign</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt; <span style="color: #949494;"># A tibble: 84 Ã— 3</span></span></span>
<span><span class="co">#&gt;&gt;    arrayID            positionInArray matchConsensus</span></span>
<span><span class="co">#&gt;&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 1</span> BAI3-1-1_ROI_00003               1 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 2</span> BAI3_ROI_00004                   1 FALSE         </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 3</span> MAI1_ROI_00004                   1 FALSE         </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 4</span> BAI3-1-1_ROI_00003               2 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 5</span> BAI3_ROI_00004                   2 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 6</span> MAI1_ROI_00004                   2 FALSE         </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 7</span> BAI3-1-1_ROI_00003               3 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 8</span> BAI3_ROI_00004                   3 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;"> 9</span> MAI1_ROI_00004                   3 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #BCBCBC;">10</span> BAI3-1-1_ROI_00003               4 TRUE          </span></span>
<span><span class="co">#&gt;&gt; <span style="color: #949494;"># â„¹ 74 more rows</span></span></span>
<span><span class="fu"><a href="../reference/matchConsensus.html">matchConsensus</a></span><span class="op">(</span><span class="va">repeatAlign</span>, returnLong <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;&gt;                    1       2       3      4       5       6       7     </span></span>
<span><span class="co">#&gt;&gt; BAI3-1-1_ROI_00003 "TRUE"  "TRUE"  "TRUE" "TRUE"  "TRUE"  "TRUE"  "TRUE"</span></span>
<span><span class="co">#&gt;&gt; BAI3_ROI_00004     "FALSE" "TRUE"  "TRUE" "TRUE"  "TRUE"  "TRUE"  "TRUE"</span></span>
<span><span class="co">#&gt;&gt; MAI1_ROI_00004     "FALSE" "FALSE" "TRUE" "FALSE" "FALSE" "FALSE" "TRUE"</span></span>
<span><span class="co">#&gt;&gt;                    8       9       10      11     12      13      14     </span></span>
<span><span class="co">#&gt;&gt; BAI3-1-1_ROI_00003 "TRUE"  "TRUE"  "TRUE"  "TRUE" "TRUE"  "TRUE"  "TRUE" </span></span>
<span><span class="co">#&gt;&gt; BAI3_ROI_00004     "TRUE"  "TRUE"  "TRUE"  "TRUE" "TRUE"  "TRUE"  "TRUE" </span></span>
<span><span class="co">#&gt;&gt; MAI1_ROI_00004     "FALSE" "FALSE" "FALSE" "TRUE" "FALSE" "FALSE" "FALSE"</span></span>
<span><span class="co">#&gt;&gt;                    15      16      17     18     19     20     21     22     </span></span>
<span><span class="co">#&gt;&gt; BAI3-1-1_ROI_00003 "TRUE"  "TRUE"  "TRUE" "TRUE" "TRUE" "TRUE" "TRUE" "TRUE" </span></span>
<span><span class="co">#&gt;&gt; BAI3_ROI_00004     "TRUE"  "TRUE"  "TRUE" "TRUE" "TRUE" "TRUE" "TRUE" "TRUE" </span></span>
<span><span class="co">#&gt;&gt; MAI1_ROI_00004     "FALSE" "FALSE" "TRUE" "TRUE" "TRUE" "TRUE" "TRUE" "FALSE"</span></span>
<span><span class="co">#&gt;&gt;                    23      24     25      26     27     28     </span></span>
<span><span class="co">#&gt;&gt; BAI3-1-1_ROI_00003 "TRUE"  "TRUE" "TRUE"  "TRUE" "TRUE" "TRUE" </span></span>
<span><span class="co">#&gt;&gt; BAI3_ROI_00004     "TRUE"  "TRUE" "TRUE"  "TRUE" "TRUE" "FALSE"</span></span>
<span><span class="co">#&gt;&gt; MAI1_ROI_00004     "FALSE" "TRUE" "FALSE" "TRUE" "TRUE" "FALSE"</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bao Tram Vi, Sebastien Cunnac.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
