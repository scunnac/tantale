<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plot in frame of heatmap.2 for Tals alignment."><title>Plotting a multiple alignment of TALE sequences — heatmap_msa • tantale</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting a multiple alignment of TALE sequences — heatmap_msa"><meta property="og:description" content="Plot in frame of heatmap.2 for Tals alignment."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tantale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9550</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/1_tale_mining.html">1. Mining TALE sequences in genomes with tantale</a>
    <a class="dropdown-item" href="../articles/2_tale_classification.html">2. Classifying TALE sequences from genomes with tantale</a>
    <a class="dropdown-item" href="../articles/3_tale_msa.html">3. Multiple alignment of TALE sequences with tantale</a>
    <a class="dropdown-item" href="../articles/4_tale_target_prediction.html">4. TALE targets predictions with tantale</a>
    <a class="dropdown-item" href="../articles/p1_distalr.html">A comparison between `runDistal` and `distalr` implementations</a>
    <a class="dropdown-item" href="../articles/p2_multiple_alignments.html">TALEs domains sequences alignment with MAFFT</a>
    <a class="dropdown-item" href="../articles/p3_tantale_objects.html">An overview of the various objects related to TALEs in tantale</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/scunnac/tantale/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plotting a multiple alignment of TALE sequences</h1>
      <small class="dont-index">Source: <a href="https://github.com/scunnac/tantale/blob/HEAD/R/msa.R" class="external-link"><code>R/msa.R</code></a></small>
      <div class="d-none name"><code>heatmap_msa.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot in frame of <code><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html" class="external-link">heatmap.2</a></code> for Tals alignment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">heatmap_msa</span><span class="op">(</span></span>
<span>  <span class="va">talsim</span>,</span>
<span>  <span class="va">repeatAlign</span>,</span>
<span>  rvdAlign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">repeatSim</span>,</span>
<span>  repeat.clust.h.cut <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  refgrep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  consensusSeq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  noteColSet <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">plot.type</span>,</span>
<span>  <span class="va">save.path</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>talsim</dt>
<dd><p>a <em>three columns Tals similarity table</em> as obtained
with <code><a href="runDistal.html">runDistal</a></code> in the 'tal.similarity' slot of the returned object.</p></dd>


<dt>repeatAlign</dt>
<dd><p>a multiple Tal repeat sequences alignment in the
form of a matrix as returned by <code><a href="buildRepeatMsa.html">buildRepeatMsa</a></code>
or as one of the elements of the <code>SeqOfRepsAlignments</code> slot in the return object
of the <code><a href="buildDisTalGroups.html">buildDisTalGroups</a></code> function.</p></dd>


<dt>rvdAlign</dt>
<dd><p>(optional) when the rvds need to be labeled in the
plot (plot.type = "repeat.similarity" or "repeat.clusters.with.rvd",
a multiple Tal repeat sequences alignment in the form of a matrix as
returned by <code><a href="buildRepeatMsa.html">buildRepeatMsa</a></code> or as one
of the elements of the <code>SeqOfRepsAlignments</code> slot in the return object
of the <code><a href="buildDisTalGroups.html">buildDisTalGroups</a></code> function.</p></dd>


<dt>repeatSim</dt>
<dd><p>A long, three columns data frame with pairwise similarity 
scores between repeats as available in the <code>repeat.similarity slot</code>
of the object returned by the <code><a href="runDistal.html">runDistal</a></code> function.
<strong>(CORRECT???!!!)</strong></p></dd>


<dt>repeat.clust.h.cut</dt>
<dd><p>height for tree cutting when plot type
in "repeat.clusters".</p></dd>


<dt>refgrep</dt>
<dd><p>regular expression pattern that will be used to search Tal names
to select the reference in the alignment.</p></dd>


<dt>consensusSeq</dt>
<dd><p>(logical) whether to display the consensus sequence when 
the plot type is "repeat.clusters.with.rvd".</p></dd>


<dt>noteColSet</dt>
<dd><p>In case rvdSim = NULL, vector of 2 colors for rvd alignment,
the first color is for matched rvds, and the second color is for mismatched ones.
In the other case, more colors should be supplied.</p></dd>


<dt>plot.type</dt>
<dd><p>Either <code>"repeat.similarity"</code>, <code>"repeat.clusters"</code> ,
<code>"repeat.clusters.with.rvd"</code>. Defines the type of plot that will be produced
 by the function. See below for details.</p></dd>


<dt>save.path</dt>
<dd><p>file path to save the plot. If save.path is NULL, the heatmap 
will be printed. If save.path is specified, the image file will be created with
the format based on file extension.</p></dd>


<dt>...</dt>
<dd><p>any other arguments of <code><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html" class="external-link">heatmap.2</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>the return value of <code><a href="https://rdrr.io/pkg/gplots/man/heatmap.2.html" class="external-link">heatmap.2</a></code></p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>"repeat.similarity" plot shows RVD alignment of Tals, a hierarchical dendrogram
 reflecting overall similarities between TALEs, similarity between repeats alignment by the color
   of cells, and (if rvdSim is provided) similarity between RVDs alignment in the 
   color of the RVD labels.</p>   
<p>"repeat.clusters" plot shows repeat alignment of Tals with cells filled with colors representing
 the repeat clustering group and a hierarchical dendrogram reflecting overall similarities
 between TALEs.</p>  
<p>"repeat.clusters.with.rvd" plots repeat alignment of Tals with rvd labeled.
 If plotting from the outputs of <code>buildDistalGroups</code>,
 you supply repeatClustID/Similarity alignment to <code>forMatrix</code>, with
 <code>talsim</code>, <code>forCellNote</code> - repeat/rvd alignment, and refgrep optionally.</p> 
<p>But if you don't have these alignments, you can provide <strong>repeat alignment</strong>
 to <code>forMatrix</code> with <code>repeatSim</code>, the repeat similarity data frame,
 the function will convert it into repeatClustID/Similarity alignment depending
 on the plot type. In case of <em>repeat.clusters</em>, you may want to adjust
 the param <code>repeat.clust.h.cut</code> to decrease/increase the number of repeat clusters.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bao Tram Vi, Sebastien Cunnac.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

