% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/msa.R
\name{heatmap_msa}
\alias{heatmap_msa}
\title{Plotting a multiple alignment of TALE sequences}
\usage{
heatmap_msa(
  talsim,
  repeatAlign,
  rvdAlign = NULL,
  repeatSim,
  repeat.clust.h.cut = 90,
  refgrep = NULL,
  consensusSeq = FALSE,
  noteColSet = NULL,
  plot.type,
  save.path,
  ...
)
}
\arguments{
\item{talsim}{a \emph{three columns Tals similarity table} as obtained
with \code{\link[tantale:runDistal]{runDistal}} in the 'tal.similarity' slot of the returned object.}

\item{repeatAlign}{a multiple Tal repeat sequences alignment in the
form of a matrix as returned by \code{\link[tantale:buildRepeatMsa]{buildRepeatMsa}}
or as one of the elements of the \code{SeqOfRepsAlignments} slot in the return object
of the \code{\link{buildDisTalGroups}} function.}

\item{rvdAlign}{(optional) when the rvds need to be labeled in the
plot (plot.type = "repeat.similarity" or "repeat.clusters.with.rvd",
a multiple Tal repeat sequences alignment in the form of a matrix as
returned by \code{\link[tantale:buildRepeatMsa]{buildRepeatMsa}} or as one
of the elements of the \code{SeqOfRepsAlignments} slot in the return object
of the \code{\link{buildDisTalGroups}} function.}

\item{repeatSim}{A long, three columns data frame with pairwise similarity 
scores between repeats as available in the \code{repeat.similarity slot}
of the object returned by the \code{\link[tantale:runDistal]{runDistal}} function.
\strong{(CORRECT???!!!)}}

\item{repeat.clust.h.cut}{height for tree cutting when plot type
in "repeat.clusters".}

\item{refgrep}{regular expression pattern that will be used to search Tal names
to select the reference in the alignment.}

\item{consensusSeq}{(logical) whether to display the consensus sequence when 
the plot type is "repeat.clusters.with.rvd".}

\item{noteColSet}{In case rvdSim = NULL, vector of 2 colors for rvd alignment,
the first color is for matched rvds, and the second color is for mismatched ones.
In the other case, more colors should be supplied.}

\item{plot.type}{Either \code{"repeat.similarity"}, \code{"repeat.clusters"} ,
\code{"repeat.clusters.with.rvd"}. Defines the type of plot that will be produced
 by the function. See below for details.}

\item{save.path}{file path to save the plot. If save.path is NULL, the heatmap 
will be printed. If save.path is specified, the image file will be created with
the format based on file extension.}

\item{...}{any other arguments of \code{\link[gplots:heatmap.2]{heatmap.2}}}
}
\value{
the return value of \code{\link[gplots:heatmap.2]{heatmap.2}}
}
\description{
Plot in frame of \code{\link[gplots:heatmap.2]{heatmap.2}} for Tals alignment.
}
\details{
"repeat.similarity" plot shows RVD alignment of Tals, a hierarchical dendrogram
 reflecting overall similarities between TALEs, similarity between repeats alignment by the color
   of cells, and (if rvdSim is provided) similarity between RVDs alignment in the 
   color of the RVD labels.
   
 "repeat.clusters" plot shows repeat alignment of Tals with cells filled with colors representing
 the repeat clustering group and a hierarchical dendrogram reflecting overall similarities
 between TALEs.
  
 "repeat.clusters.with.rvd" plots repeat alignment of Tals with rvd labeled.
 If plotting from the outputs of \code{buildDistalGroups},
 you supply repeatClustID/Similarity alignment to \code{forMatrix}, with
 \code{talsim}, \code{forCellNote} - repeat/rvd alignment, and refgrep optionally.
 
 But if you don't have these alignments, you can provide \strong{repeat alignment}
 to \code{forMatrix} with \code{repeatSim}, the repeat similarity data frame,
 the function will convert it into repeatClustID/Similarity alignment depending
 on the plot type. In case of \emph{repeat.clusters}, you may want to adjust
 the param \code{repeat.clust.h.cut} to decrease/increase the number of repeat clusters.
}
